<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [config](#config)
    -   [upload.chunkSizes](#uploadchunksizes)
    -   [upload.getChunkSize](#uploadgetchunksize)
    -   [upload.encryptBufferSize](#uploadencryptbuffersize)
    -   [upload.uploadBufferSize](#uploaduploadbuffersize)
    -   [upload.uploadBufferSize](#uploaduploadbuffersize-1)
    -   [debug.trafficReportInterval](#debugtrafficreportinterval)
    -   [debug.socketLogEnabled](#debugsocketlogenabled)
    -   [socketServerUrl](#socketserverurl)
    -   [ghostFrontendUrl](#ghostfrontendurl)
    -   [appVersion](#appversion)
    -   [platform](#platform)
    -   [CHUNK_OVERHEAD](#chunk_overhead)
    -   [download.maxDownloadChunkSize](#downloadmaxdownloadchunksize)
    -   [download.maxDecryptBufferSize](#downloadmaxdecryptbuffersize)
    -   [FileStream](#filestream)
    -   [StorageEngine](#storageengine)
    -   [observableClockEventFrequency](#observableclockeventfrequency)
    -   [serverPlans](#serverplans)
    -   [serverPlansPremium](#serverplanspremium)
    -   [serverPlansPro](#serverplanspro)
    -   [chat.maxInitialChats](#chatmaxinitialchats)
    -   [chat.initialPageSize](#chatinitialpagesize)
    -   [chat.pageSize](#chatpagesize)
    -   [chat.maxLoadedMessages](#chatmaxloadedmessages)
    -   [chat.decryptQueueThrottle](#chatdecryptqueuethrottle)
    -   [chat.maxDMParticipants](#chatmaxdmparticipants)
-   [crypto/keys](#cryptokeys)
    -   [deriveAccountKeys](#deriveaccountkeys)
    -   [deriveEphemeralKeys](#deriveephemeralkeys)
    -   [deriveKeyFromPasscode](#derivekeyfrompasscode)
    -   [generateSigningKeyPair](#generatesigningkeypair)
    -   [generateEncryptionKeyPair](#generateencryptionkeypair)
    -   [generateEncryptionKey](#generateencryptionkey)
    -   [generateAuthSalt](#generateauthsalt)
    -   [getAuthKeyHash](#getauthkeyhash)
-   [crypto/public](#cryptopublic)
    -   [decryptCompat](#decryptcompat)
    -   [encrypt](#encrypt)
    -   [decrypt](#decrypt)
    -   [computeSharedKey](#computesharedkey)
-   [crypto/scrypt-proxy](#cryptoscrypt-proxy)
    -   [getScrypt](#getscrypt)
    -   [setScrypt](#setscrypt)
-   [crypto/secret](#cryptosecret)
    -   [NONCE_SIZE](#nonce_size)
    -   [encrypt](#encrypt-1)
    -   [encryptString](#encryptstring)
    -   [decrypt](#decrypt-1)
    -   [decryptString](#decryptstring)
-   [crypto/sign](#cryptosign)
    -   [signDetached](#signdetached)
    -   [verifyDetached](#verifydetached)
    -   [setImplementation](#setimplementation)
-   [crypto/util](#cryptoutil)
    -   [strToBytes](#strtobytes)
    -   [bytesToStr](#bytestostr)
    -   [b64ToBytes](#b64tobytes)
    -   [bytesToB64](#bytestob64)
    -   [bytesToHex](#bytestohex)
    -   [hexToBytes](#hextobytes)
    -   [numberToByteArray](#numbertobytearray)
    -   [byteArrayToNumber](#bytearraytonumber)
    -   [getHexHash](#gethexhash)
    -   [getByteHash](#getbytehash)
    -   [getFingerprint](#getfingerprint)
    -   [concatTypedArrays](#concattypedarrays)
    -   [MAX_PASSPHRASE_LENGTH](#max_passphrase_length)
    -   [padBytes](#padbytes)
    -   [padPassphrase](#padpassphrase)
    -   [unpadPassphrase](#unpadpassphrase)
    -   [getRandomBytes](#getrandombytes)
    -   [getRandomNumber](#getrandomnumber)
    -   [getRandomNonce](#getrandomnonce)
    -   [getRandomUserSpecificIdBytes](#getrandomuserspecificidbytes)
    -   [getRandomUserSpecificIdB64](#getrandomuserspecificidb64)
    -   [getRandomUserSpecificIdHex](#getrandomuserspecificidhex)
-   [StorageEngineInterface](#storageengineinterface)
    -   [getValue](#getvalue)
    -   [setValue](#setvalue)
    -   [removeValue](#removevalue)
    -   [getAllKeys](#getallkeys)
    -   [clear](#clear)
-   [TinyDbManager](#tinydbmanager)
    -   [system](#system)
    -   [user](#user)
-   [errors](#errors)
    -   [normalize](#normalize)
    -   [getGenericCustomError](#getgenericcustomerror)
    -   [serverErrorCodes](#servererrorcodes)
    -   [ServerError](#servererror)
-   [extensions/uint8array](#extensionsuint8array)
    -   [slice](#slice)
-   [ArrayStream](#arraystream)
    -   [peek](#peek)
    -   [read](#read)
    -   [length](#length)
-   [helpers/file](#helpersfile)
    -   [getFileName](#getfilename)
    -   [getFileNameWithoutExtension](#getfilenamewithoutextension)
    -   [getFileExtension](#getfileextension)
-   [MRUList](#mrulist)
    -   [list](#list)
    -   [loadCache](#loadcache)
    -   [addItem](#additem)
-   [Clock](#clock)
    -   [now](#now)
    -   [dispose](#dispose)
    -   [default](#default)
-   [Timer](#timer)
    -   [counter](#counter)
    -   [countUp](#countup)
    -   [countDown](#countdown)
    -   [stop](#stop)
-   [Queue](#queue)
    -   [tasks](#tasks)
    -   [runningTasks](#runningtasks)
    -   [length](#length-1)
    -   [addTask](#addtask)
-   [helpers/system-messages](#helperssystem-messages)
    -   [getSystemMessageText](#getsystemmessagetext)
-   [helpers/field-validation](#helpersfield-validation)
    -   [addValidation](#addvalidation)
-   [helpers/user-validators](#helpersuser-validators)
-   [index](#index)
-   [ChatHead](#chathead)
    -   [chatName](#chatname)
    -   [purpose](#purpose)
-   [ChatInviteStore](#chatinvitestore)
    -   [received](#received)
    -   [sent](#sent)
    -   [acceptInvite](#acceptinvite)
    -   [rejectInvite](#rejectinvite)
    -   [revokeInvite](#revokeinvite)
-   [ChatStore](#chatstore)
    -   [events](#events)
    -   [chats](#chats)
    -   [unreadChatsAlwaysOnTop](#unreadchatsalwaysontop)
    -   [loading](#loading)
    -   [activeChat](#activechat)
    -   [hidingChat](#hidingchat)
    -   [loaded](#loaded)
    -   [unreadMessages](#unreadmessages)
    -   [directMessages](#directmessages)
    -   [channels](#channels)
    -   [hasChannels](#haschannels)
    -   [loadAllChats](#loadallchats)
    -   [startChat](#startchat)
    -   [activate](#activate)
    -   [deactivateCurrentChat](#deactivatecurrentchat)
    -   [startChatAndShareFiles](#startchatandsharefiles)
    -   [unloadChat](#unloadchat)
-   [addChat](#addchat)
-   [ChatFileHandler](#chatfilehandler)
    -   [uploadAndShare](#uploadandshare)
-   [Chat](#chat)
    -   [id](#id)
    -   [messages](#messages)
    -   [limboMessages](#limbomessages)
    -   [participants](#participants)
    -   [participants](#participants-1)
    -   [loadingMeta](#loadingmeta)
    -   [metaLoaded](#metaloaded)
    -   [loadingInitialPage](#loadinginitialpage)
    -   [initialPageLoaded](#initialpageloaded)
    -   [mostRecentMessageLoaded](#mostrecentmessageloaded)
    -   [loadingTopPage](#loadingtoppage)
    -   [loadingBottomPage](#loadingbottompage)
    -   [canGoUp](#cangoup)
    -   [canGoDown](#cangodown)
    -   [active](#active)
    -   [active](#active-1)
    -   [isFavorite](#isfavorite)
    -   [changingFavState](#changingfavstate)
    -   [leaving](#leaving)
    -   [uploadQueue](#uploadqueue)
    -   [unreadCount](#unreadcount)
    -   [newMessagesMarkerPos](#newmessagesmarkerpos)
    -   [chatHead](#chathead-1)
    -   [isReadOnly](#isreadonly)
    -   [participantUsernames](#participantusernames)
    -   [name](#name)
    -   [purpose](#purpose-1)
    -   [canSendAck](#cansendack)
    -   [showNewMessagesMarker](#shownewmessagesmarker)
    -   [canIAdmin](#caniadmin)
    -   [canILeave](#canileave)
    -   [mostRecentMessage](#mostrecentmessage)
    -   [removeMessage](#removemessage)
    -   [sendAck](#sendack)
    -   [uploadAndShareFile](#uploadandsharefile)
    -   [shareFiles](#sharefiles)
    -   [loadPreviousPage](#loadpreviouspage)
    -   [loadNextPage](#loadnextpage)
    -   [rename](#rename)
    -   [changePurpose](#changepurpose)
    -   [reset](#reset)
    -   [delete](#delete)
    -   [addParticipants](#addparticipants)
    -   [promoteToAdmin](#promotetoadmin)
    -   [demoteAdmin](#demoteadmin)
    -   [isAdmin](#isadmin)
    -   [removeParticipant](#removeparticipant)
    -   [leave](#leave)
-   [toggleFavoriteState](#togglefavoritestate)
-   [hide](#hide)
-   [unhide](#unhide)
-   [Message](#message)
    -   [sending](#sending)
    -   [sendError](#senderror)
    -   [receipts](#receipts)
    -   [userMentions](#usermentions)
    -   [firstOfTheDay](#firstoftheday)
    -   [groupWithPrevious](#groupwithprevious)
    -   [inlineImages](#inlineimages)
    -   [dayFingerprint](#dayfingerprint)
    -   [messageTimestampText](#messagetimestamptext)
-   [sender](#sender)
-   [text](#text)
-   [systemData](#systemdata)
-   [timestamp](#timestamp)
-   [files](#files)
-   [isMention](#ismention)
-   [MyChats](#mychats)
    -   [favorites](#favorites)
    -   [hidden](#hidden)
    -   [addFavorite](#addfavorite)
    -   [removeFavorite](#removefavorite)
    -   [addHidden](#addhidden)
    -   [removeHidden](#removehidden)
-   [ReadReceipt](#readreceipt)
    -   [chatPosition](#chatposition)
    -   [receiptError](#receipterror)
-   [ClientApp](#clientapp)
    -   [isFocused](#isfocused)
    -   [isInChatsView](#isinchatsview)
    -   [isInFilesView](#isinfilesview)
    -   [clientVersionDeprecated](#clientversiondeprecated)
-   [active2FARequest](#active2farequest)
-   [ContactStore](#contactstore)
    -   [contacts](#contacts)
    -   [addedContacts](#addedcontacts)
    -   [invitedContacts](#invitedcontacts)
    -   [uiViewSortBy](#uiviewsortby)
    -   [uiViewFilter](#uiviewfilter)
    -   [uiViewSearchQuery](#uiviewsearchquery)
    -   [uiView](#uiview)
    -   [addContact](#addcontact)
    -   [addContactBatch](#addcontactbatch)
    -   [importContacts](#importcontacts)
    -   [removeContact](#removecontact)
    -   [removeInvite](#removeinvite)
    -   [removeReceivedInvite](#removereceivedinvite)
    -   [getContact](#getcontact)
    -   [invite](#invite)
    -   [filter](#filter)
-   [Contact](#contact)
    -   [loading](#loading-1)
    -   [username](#username)
    -   [usernameTag](#usernametag)
    -   [firstName](#firstname)
    -   [lastName](#lastname)
    -   [encryptionPublicKey](#encryptionpublickey)
    -   [signingPublicKey](#signingpublickey)
    -   [tofuError](#tofuerror)
    -   [isAdded](#isadded)
    -   [urlSalt](#urlsalt)
    -   [profileVersion](#profileversion)
    -   [hasAvatar](#hasavatar)
    -   [isDeleted](#isdeleted)
    -   [color](#color)
    -   [letter](#letter)
    -   [fullName](#fullname)
    -   [fullNameAndUsername](#fullnameandusername)
    -   [fullNameLower](#fullnamelower)
    -   [fingerprint](#fingerprint)
    -   [largeAvatarUrl](#largeavatarurl)
    -   [mediumAvatarUrl](#mediumavatarurl)
    -   [fingerprintSkylarFormatted](#fingerprintskylarformatted)
    -   [notFound](#notfound)
    -   [isLegacy](#islegacy)
    -   [load](#load)
    -   [whenLoaded](#whenloaded)
    -   [ensureLoaded](#ensureloaded)
    -   [ensureAllLoaded](#ensureallloaded)
-   [Invites](#invites)
    -   [issued](#issued)
-   [Tofu](#tofu)
    -   [username](#username-1)
    -   [firstName](#firstname-1)
    -   [lastName](#lastname-1)
    -   [encryptionPublicKey](#encryptionpublickey-1)
    -   [signingPublicKey](#signingpublickey-1)
    -   [getByUsername](#getbyusername)
-   [FileStore](#filestore)
    -   [files](#files-1)
    -   [loading](#loading-2)
    -   [currentFilter](#currentfilter)
    -   [updating](#updating)
    -   [uploadQueue](#uploadqueue-1)
    -   [hasSelectedFiles](#hasselectedfiles)
    -   [canShareSelectedFiles](#canshareselectedfiles)
    -   [allVisibleSelected](#allvisibleselected)
    -   [selectedCount](#selectedcount)
    -   [getSelectedFiles](#getselectedfiles)
    -   [getShareableSelectedFiles](#getshareableselectedfiles)
    -   [clearSelection](#clearselection)
    -   [selectAll](#selectall)
    -   [deselectUnshareableFiles](#deselectunshareablefiles)
    -   [filterByName](#filterbyname)
    -   [clearFilter](#clearfilter)
    -   [loadAllFiles](#loadallfiles)
    -   [getById](#getbyid)
-   [upload](#upload)
-   [FileStreamAbstract](#filestreamabstract)
    -   [filePath](#filepath)
    -   [mode](#mode)
    -   [pos](#pos)
    -   [open](#open)
    -   [close](#close)
    -   [getFullPath](#getfullpath)
    -   [exists](#exists)
    -   [launchViewer](#launchviewer)
    -   [getStat](#getstat)
    -   [getCacheList](#getcachelist)
    -   [delete](#delete-1)
-   [read](#read-1)
-   [write](#write)
-   [seek](#seek)
-   [File](#file)
    -   [download](#download)
    -   [cancelDownload](#canceldownload)
    -   [key](#key)
    -   [nonce](#nonce)
    -   [fileId](#fileid)
    -   [name](#name-1)
    -   [size](#size)
    -   [uploadedAt](#uploadedat)
    -   [fileOwner](#fileowner)
    -   [readyForDownload](#readyfordownload)
    -   [uploading](#uploading)
    -   [downloading](#downloading)
    -   [progress](#progress)
    -   [progressMax](#progressmax)
    -   [cached](#cached)
    -   [selected](#selected)
    -   [show](#show)
    -   [uploadCancelled](#uploadcancelled)
    -   [shared](#shared)
    -   [ext](#ext)
    -   [cachePath](#cachepath)
    -   [sizeFormatted](#sizeformatted)
    -   [chunksCount](#chunkscount)
    -   [canShare](#canshare)
    -   [sizeWithOverhead](#sizewithoverhead)
    -   [share](#share)
    -   [launchViewer](#launchviewer-1)
    -   [deleteCache](#deletecache)
    -   [remove](#remove)
    -   [rename](#rename-1)
    -   [upload](#upload-1)
    -   [cancelUpload](#cancelupload)
-   [NodeFileStream](#nodefilestream)
-   [BootKeg](#bootkeg)
    -   [signKeys](#signkeys)
    -   [encryptionKeys](#encryptionkeys)
    -   [kegKey](#kegkey)
-   [ChatBootKeg](#chatbootkeg)
    -   [participants](#participants-2)
    -   [admins](#admins)
    -   [addParticipant](#addparticipant)
    -   [removeParticipant](#removeparticipant-1)
-   [ChatKegDb](#chatkegdb)
    -   [id](#id-1)
    -   [key](#key-1)
    -   [keyId](#keyid)
    -   [boot](#boot)
    -   [participants](#participants-3)
    -   [admins](#admins-1)
    -   [participantsToCreateWith](#participantstocreatewith)
    -   [dbIsBroken](#dbisbroken)
    -   [isChannel](#ischannel)
-   [KegDb](#kegdb)
    -   [id](#id-2)
    -   [key](#key-2)
    -   [keyId](#keyid-1)
    -   [boot](#boot-1)
-   [Keg](#keg)
    -   [type](#type)
    -   [db](#db)
    -   [plaintext](#plaintext)
    -   [overrideKey](#overridekey)
    -   [version](#version)
    -   [format](#format)
    -   [collectionVersion](#collectionversion)
    -   [props](#props)
    -   [forceSign](#forcesign)
    -   [allowEmpty](#allowempty)
    -   [storeSignerData](#storesignerdata)
    -   [signatureError](#signatureerror)
    -   [sharedKegError](#sharedkegerror)
    -   [id](#id-3)
    -   [tempId](#tempid)
    -   [deleted](#deleted)
    -   [loading](#loading-3)
    -   [saving](#saving)
    -   [dirty](#dirty)
    -   [lastLoadHadError](#lastloadhaderror)
    -   [isEmpty](#isempty)
    -   [assignTemporaryId](#assigntemporaryid)
    -   [saveToServer](#savetoserver)
    -   [load](#load-1)
    -   [remove](#remove-1)
    -   [loadFromKeg](#loadfromkeg)
    -   [serializeKegPayload](#serializekegpayload)
    -   [deserializeKegPayload](#deserializekegpayload)
    -   [serializeProps](#serializeprops)
    -   [deserializeProps](#deserializeprops)
-   [SyncedKeg](#syncedkeg)
    -   [loaded](#loaded-1)
    -   [reload](#reload)
    -   [save](#save)
-   [PhraseDictionary](#phrasedictionary)
    -   [getPassphrase](#getpassphrase)
    -   [dispose](#dispose-1)
    -   [current](#current)
    -   [setDictionary](#setdictionary)
-   [ServerSettings](#serversettings)
    -   [avatarServer](#avatarserver)
    -   [acceptableClientVersions](#acceptableclientversions)
    -   [tag](#tag)
-   [NodeJsonStorage](#nodejsonstorage)
-   [Settings](#settings)
    -   [contactNotifications](#contactnotifications)
    -   [contactRequestNotifications](#contactrequestnotifications)
    -   [messageNotifications](#messagenotifications)
    -   [errorTracking](#errortracking)
    -   [dataCollection](#datacollection)
    -   [subscribeToPromoEmails](#subscribetopromoemails)
-   [User](#user-1)
    -   [setup2fa](#setup2fa)
    -   [confirm2faSetup](#confirm2fasetup)
    -   [disable2fa](#disable2fa)
    -   [reissueBackupCodes](#reissuebackupcodes)
    -   [serializeAuthData](#serializeauthdata)
    -   [deserializeAuthData](#deserializeauthdata)
    -   [disablePasscode](#disablepasscode)
    -   [passcodeIsDisabled](#passcodeisdisabled)
    -   [setPasscode](#setpasscode)
    -   [validatePasscode](#validatepasscode)
    -   [hasPasscode](#haspasscode)
    -   [firstName](#firstname-2)
    -   [lastName](#lastname-2)
    -   [email](#email)
    -   [locale](#locale)
    -   [passcodeIsSet](#passcodeisset)
    -   [profileLoaded](#profileloaded)
    -   [primaryAddressConfirmed](#primaryaddressconfirmed)
    -   [deleted](#deleted-1)
    -   [blacklisted](#blacklisted)
    -   [savingAvatar](#savingavatar)
    -   [autologinEnabled](#autologinenabled)
    -   [secureWithTouchID](#securewithtouchid)
    -   [twoFAEnabled](#twofaenabled)
    -   [fullName](#fullname-1)
    -   [createdAt](#createdat)
    -   [passphrase](#passphrase)
    -   [authSalt](#authsalt)
    -   [authKeys](#authkeys)
    -   [signKeys](#signkeys-1)
    -   [encryptionKeys](#encryptionkeys-1)
    -   [emojiMRU](#emojimru)
    -   [activePlans](#activeplans)
    -   [fileQuotaTotal](#filequotatotal)
    -   [fileQuotaTotalFmt](#filequotatotalfmt)
    -   [fileQuotaLeft](#filequotaleft)
    -   [fileQuotaLeftFmt](#filequotaleftfmt)
    -   [fileSizeLimit](#filesizelimit)
    -   [fileSizeLimitFmt](#filesizelimitfmt)
    -   [fileQuotaUsed](#filequotaused)
    -   [fileQuotaUsedFmt](#filequotausedfmt)
    -   [fileQuotaUsedPercent](#filequotausedpercent)
    -   [channelLimit](#channellimit)
    -   [channelsLeft](#channelsleft)
    -   [maxInvitedPeopleBonus](#maxinvitedpeoplebonus)
    -   [currentInvitedPeopleBonus](#currentinvitedpeoplebonus)
    -   [maximumOnboardingBonus](#maximumonboardingbonus)
    -   [currentOnboardingBonus](#currentonboardingbonus)
    -   [canUploadFileSize](#canuploadfilesize)
    -   [canUploadMaxFileSize](#canuploadmaxfilesize)
    -   [createAccountAndLogin](#createaccountandlogin)
    -   [login](#login)
    -   [setAsLastAuthenticated](#setaslastauthenticated)
    -   [settings](#settings-1)
    -   [resendEmailConfirmation](#resendemailconfirmation)
    -   [removeEmail](#removeemail)
    -   [addEmail](#addemail)
    -   [makeEmailPrimary](#makeemailprimary)
    -   [saveAvatar](#saveavatar)
    -   [deleteAvatar](#deleteavatar)
    -   [setAccountKeyBackedUp](#setaccountkeybackedup)
    -   [current](#current-1)
    -   [getLastAuthenticated](#getlastauthenticated)
    -   [removeLastAuthenticated](#removelastauthenticated)
-   [username](#username-2)
-   [Warnings](#warnings)
    -   [add](#add)
    -   [addSevere](#addsevere)
    -   [current](#current-2)
-   [SocketClient](#socketclient)
    -   [started](#started)
    -   [url](#url)
    -   [connected](#connected)
    -   [authenticated](#authenticated)
    -   [throttled](#throttled)
    -   [reconnectAttempt](#reconnectattempt)
    -   [reconnecting](#reconnecting)
    -   [latency](#latency)
    -   [reconnectTimer](#reconnecttimer)
    -   [bytesReceived](#bytesreceived)
    -   [bytesSent](#bytessent)
    -   [STATES](#states)
    -   [SOCKET_EVENTS](#socket_events)
    -   [APP_EVENTS](#app_events)
    -   [start](#start)
    -   [state](#state)
    -   [subscribe](#subscribe)
    -   [unsubscribe](#unsubscribe)
    -   [send](#send)
    -   [onceConnected](#onceconnected)
    -   [onceAuthenticated](#onceauthenticated)
    -   [onceStarted](#oncestarted)
    -   [onAuthenticated](#onauthenticated)
    -   [onDisconnect](#ondisconnect)
    -   [close](#close-1)
    -   [open](#open-1)
    -   [reset](#reset-1)
-   [socket](#socket)
-   [Address](#address)
-   [KeyPair](#keypair)
-   [InvitedContact](#invitedcontact)
-   [TwoFARequest](#twofarequest)
-   [util](#util)
    -   [convertBuffers](#convertbuffers)
    -   [formatBytes](#formatbytes)

## config

Configuration module.
Exists just to collect most of the app configuration aspects in one place.

**Following properties have to be set before client app starts using Icebear SDK.**
Best to do it in your local config.js

-   socketServerUrl
-   ghostFrontendUrl
-   appVersion
-   platform
-   FileStream
-   StorageEngine

### upload.chunkSizes

For reference. Table of chunk sizes based on file sizes.
Is not supposed to be changed ever.
If you do change it for some reason - remember to restart paused uploads as file chunk size might change.

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;{maxFileSize: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)?, chunkSize: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)}>

### upload.getChunkSize

Finds which chunk size to use for given file size based on [chunkSizes](chunkSizes) reference table.

**Parameters**

-   `fileSize` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** in bytes.

Returns **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** chunk size to use, in bytes.

### upload.encryptBufferSize

Max amount of bytes to buffer from disk for encrypting.
This number can't be less than maximum chunk size.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### upload.uploadBufferSize

Max amount of chunks to pre-encrypt for sending
This number can't be less than maximum chunk size.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### upload.uploadBufferSize

Max amount of uploaded chunks per one file waiting for server response.
When reached this number, uploader will wait for at least one chunk to get a response.
Bigger number = faster upload = more pressure on server.
0-5 is a reasonable range to pick. Default is 2.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### debug.trafficReportInterval

Traffic stat summary will be logged with this interval (ms.)

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### debug.socketLogEnabled

All socket messages will be logged if set to `true` before socket is started.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### socketServerUrl

App server connection url. (wss://)

**Client app is required to set this property before using Icebear SDK.**

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### ghostFrontendUrl

Ghost website url. (https&#x3A;//)

**Client app is required to set this property before using Icebear SDK.**

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### appVersion

Application version (semver).
Will be used by server to detect deprecated client versions.

**Client app is required to set this property before using Icebear SDK.**

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### platform

Strictly one of: 'electron', 'outlook', 'android', 'ios', 'browser',
unless server has been updated to support more platform strings and this documentation wasn't :-P

**Client app is required to set this property before using Icebear SDK.**

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### CHUNK_OVERHEAD

For reference. Amount of bytes added to every file chunk in encrypted state.
DO NOT change this value unless you really know what you're doing.

Returns **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 32

### download.maxDownloadChunkSize

Max amount of bytes to download at once for further processing.
File gets downloaded in 'downloadChunks' and then broken down to the chunk size it was uploaded with.
This number can't be less than maximum chunk size.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### download.maxDecryptBufferSize

Max amount of bytes to download and queue for decryption.
This number can't be less than maximum chunk size.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### FileStream

File stream implementation class.

**Client app is required to set this property before using Icebear SDK.**

Type: [FileStreamAbstract](#filestreamabstract)

### StorageEngine

Storage engine implementation class.

**Client app is required to set this property before using Icebear SDK.**

Type: [StorageEngineInterface](#storageengineinterface)

### observableClockEventFrequency

Frequency (seconds) at which default observable clock will be changing its value.
Default clock can be used for refreshing timestamps and other time counters.
Do not set this value too low, create custom clocks instead.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### serverPlans

Server plans ids

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### serverPlansPremium

Server premium plans ids

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### serverPlansPro

Server pro plans ids

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### chat.maxInitialChats

Maximum amount of chats to load initially. Favorite chats will ignore this and load in full number.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### chat.initialPageSize

Amount of messages to load to a chat initially.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### chat.pageSize

When navigating chat history, load this amount of messages per page.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### chat.maxLoadedMessages

Icebear will unload messages over this limit, resulting is low memory consumption when navigating history
or chatting normally.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### chat.decryptQueueThrottle

Delay (ms) between decryption of individual messages when processing a batch.
Increase to get more responsiveness, but increase page load time.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### chat.maxDMParticipants

Maximum amount of participants for direct message (including creator)

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

## crypto/keys

Peerio Crypto module for key handling.

### deriveAccountKeys

Deterministically derives symmetrical boot key and auth key pair.

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `passphrase` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `randomSalt` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 random bytes

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;{bootKey: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array), authKeyPair: [KeyPair](#keypair)}>** 

### deriveEphemeralKeys

Derive keys for a ghost/ephemeral user.

**Parameters**

-   `salt` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** e.g. ephemeral ID
-   `passphrase` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[KeyPair](#keypair)>** 

### deriveKeyFromPasscode

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `passcode` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)>** 

### generateSigningKeyPair

Generates new random signing (ed25519) key pair.

Returns **[KeyPair](#keypair)** 32 byte public key and 64 byte secret key.

### generateEncryptionKeyPair

Generates new random asymmetric (curve25519) key pair.

Returns **[KeyPair](#keypair)** 32 byte keys

### generateEncryptionKey

Generates new random symmetric (xsalsa20) 32 byte secret key.

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes

### generateAuthSalt

Generates new salt for auth process

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes

### getAuthKeyHash

Hashes auth public key. Uses personalized hash.

**Parameters**

-   `key`  

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes personalized hash

## crypto/public

Public key encryption module

### decryptCompat

This is a classic variant of decryption function for server compatibility.
It's used for decrypting authTokens and other tokens. For everything else client uses optimized version
[decrypt](decrypt)

**Parameters**

-   `cipher` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** encrypted bytes
-   `nonce` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 24 byte nonce
-   `theirPublicKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** message sender's public key
-   `mySecretKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** decrypting user's secret key

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** decrypted bytes

### encrypt

Encrypt using public key crypto.
WARNING: this function is ok to use for occasional operations, but for performance-critical parts it's better
to use crypto/secret.encrypt [crypto/secret:encrypt](crypto/secret:encrypt) with precalculated shared key from User class [User](#user)

**Parameters**

-   `msgBytes` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** unencrypted message
-   `theirPublicKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** message recipient's public key
-   `mySecretKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** encrypting user's secret key

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** encrypted bytes

### decrypt

Decrypt using public key crypto.
WARNING: this function is ok to use for occasional operations, but for performance-critical parts it's better
to use crypto/secret.encrypt [crypto/secret:encrypt](crypto/secret:encrypt) with precalculated shared key from User class [User](#user)

**Parameters**

-   `cipher` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** encrypted bytes
-   `theirPublicKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** message sender's public key
-   `mySecretKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** decrypting user's secret key

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** decrypted bytes

### computeSharedKey

Calculates shared key for public key crypto.

**Parameters**

-   `theirPublicKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** other user's public key
-   `mySecretKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** current user's secret key

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes shared key

## crypto/scrypt-proxy

Mobile UI thread suffocates even with async scrypt so we let mobile implement scrypt in a worker thread.

### getScrypt

Returns chosen scrypt implementation.

Returns **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** scrypt

### setScrypt

Sets chosen scrypt implementation.

**Parameters**

-   `fn` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** scrypt

## crypto/secret

Secret key encryption module.

Encrypt and decrypt functions replace `nacl.secretbox` and `nacl.secretbox.open`
see tweetnacl-js <https://github.com/dchest/tweetnacl-js>.
This replacement reduces the amount of memory allocation and copy operations.

The output cipher bytes have following differences with `nacl.secretbox` output:

-   nonce is appended to the cipher bytes.
-   16 BOXZEROBYTES in the beginning of cipher bytes are not stripped and another 16 are appended to them
    because we'll need them for decryption

Cipherbytes structure:
`[ 32 zero bytes ][ actual cipher bytes ][ 24-byte nonce]`

### NONCE_SIZE

24 - The size of the nonce is used for encryption

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### encrypt

Encrypts and authenticates data using symmetric encryption.
This is a refactored version of nacl.secretbox().

**Parameters**

-   `msgBytes` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 
-   `key` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes symmetric key
-   `nonce` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** in case you want to set your own nonce. 24 bytes. (optional, default `getRandomNonce()`)
-   `appendNonce` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** appends nonce to the end of encrypted bytes (optional, default `true`)
-   `prependLength` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** adds 4 bytes containing message length after encryption to the beginning (optional, default `false`)

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** encrypted bytes

### encryptString

Helper method to decode string to bytes and encrypt it.

**Parameters**

-   `msg` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** message to encrypt
-   `key` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes symmetric key

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** encrypted bytes

### decrypt

Decrypts and authenticates data using symmetric encryption.
This is a refactored version of nacl.secretbox.open().

**Parameters**

-   `cipher` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** cipher bytes with 16 zerobytes prepended and optionally appended nonce
-   `key` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes symmetric key
-   `nonce` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** pass nonce when it's not appended to cipher bytes (optional, default `'will be extracted from message'`)
-   `containsLength` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** whether or not to ignore first 4 bytes (optional, default `false`)

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** decrypted message

### decryptString

Helper method to decode decrypted data to a string.

**Parameters**

-   `cipher` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** encrypted message
-   `key` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes symmetric key

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** decrypted message

## crypto/sign

Digital signing module

### signDetached

Signs the message with secret key and returns detached signature

**Parameters**

-   `message` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** any data that needs signing
-   `secretKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 64 bytes secret key from the signing user's signing key pair.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)>** 64 bytes signature

### verifyDetached

Verifies message signature

**Parameters**

-   `message` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** any data that needs verifying
-   `signature` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 64 bytes
-   `publicKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes public key from the signing user's signing key pair.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)>** verification result

### setImplementation

Allows overriding of sign and verify functions in case it has to be an async implementation.
Mobile currently uses this.

**Parameters**

-   `signFunc` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** see [signDetached](signDetached)
-   `verifyFunc` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** see [verifyDetached](verifyDetached)

## crypto/util

Peerio crypto utilities module.
Exported from icebear index as `crypto.cryptoUtil`

### strToBytes

Converts UTF8 string to byte array.
Uses native TextEncoder or Buffer.

**Parameters**

-   `str` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** string to convert to byte array

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** utf8 decoded bytes

### bytesToStr

Converts byte array to UTF8 string.
Uses native TextEncoder or Buffer.

**Parameters**

-   `bytes` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** utf8 bytes

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** encoded string

### b64ToBytes

Converts Base64 string to byte array.

**Parameters**

-   `str` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** B64 string to decode

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 

### bytesToB64

Converts Uint8Array or ArrayBuffer to Base64 string.

**Parameters**

-   `bytes` **([Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array) \| [ArrayBuffer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer))** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** B64 string encoded bytes

### bytesToHex

Converts Uint8Array or ArrayBuffer to hex encoded string.

**Parameters**

-   `bytes` **([Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array) \| [ArrayBuffer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer))** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** B64 string encoded bytes (no 0x or other prefix, just data)

### hexToBytes

Converts hex string to byte array.

**Parameters**

-   `str` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** hex string to decode, no prefixes, just data

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 

### numberToByteArray

Converts 32-bit unsigned integer to byte array.

**Parameters**

-   `num` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 32-bit unsigned integer

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 

### byteArrayToNumber

Converts bytes to 32-bit unsigned integer.

**Parameters**

-   `arr` **([UInt8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array) \| [ArrayBuffer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer))** 4 bytes representing unsigned integer
-   `offset`  
-   `length`  

Returns **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 32-bit unsigned integer

### getHexHash

Hashes a value and returns hex string.

**Parameters**

-   `length` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** hash length 1-32
-   `value` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** value to hash
-   `personalizationString` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** hex encoded hash

### getByteHash

Hashes a value and returns hash bytes.

**Parameters**

-   `length` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** hash length 1-32
-   `value` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** value to hash
-   `personalizationString` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** 

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** hash bytes

### getFingerprint

Returns user fingerprint string.

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `publicKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** fingerprint. Example: `51823-23479-94038-76454-79776-13778`

### concatTypedArrays

Concatenates two Uint8Arrays.

**Parameters**

-   `arr1` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 
-   `arr2` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** new concatenated array.

### MAX_PASSPHRASE_LENGTH

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

Returns **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 1024

### padBytes

Adds 0 bytes to the end of a Uint8Array until it is `length` bytes long.

**Parameters**

-   `arr` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 
-   `length` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** new zero-padded array

### padPassphrase

Pads passphrase (aka Account Key) to MAX_PASSPHRASE_LENGTH + 8
characters.

**Parameters**

-   `passphrase` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 


-   Throws **any** if passphrase is too long

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** passhprase padded with dots `.`

### unpadPassphrase

Unpads passphrase (aka Account Key) padded by [padPassphrase](padPassphrase).

**Parameters**

-   `paddedPassphrase` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 


-   Throws **any** if padded passphrase is too short

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** unpadded passphrase

### getRandomBytes

Generates random bytes suitable for crypto use

**Parameters**

-   `num` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** byte count to return

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** random bytes array of `num` size

### getRandomNumber

Generated cryptographically secure random number in a set range.
Range can't be more then 2\*\*31 (2147483648).

**Parameters**

-   `min` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** minimum random number value (inclusive) (optional, default `0`)
-   `max` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** maximum random value (exclusive) (optional, default `2147483648`)


-   Throws **InvalidArgumentError** 

Returns **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** random number

### getRandomNonce

Generates 24-byte unique random nonce.
Partially consists of 4 bytes of current timestamp. 4 bytes fits almost 50 days worth of milliseconds,
so if you are generating 1 nonce every millisecond, it's guaranteed to have no collisions within 50 days
even without random bytes part.

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 24 bytes, [4: from timestamp][20: random]

### getRandomUserSpecificIdBytes

Generates random id bytes.
Partially consists of hashed username and timestamp.

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 42 bytes, [16: username+timestamp hash][26: random bytes]

### getRandomUserSpecificIdB64

Same as [crypto/util:getRandomUserSpecificIdBytes](crypto/util:getRandomUserSpecificIdBytes) but returns B64 string

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** id in base64 encoding

### getRandomUserSpecificIdHex

-   **See: crypto/util:getRandomUserSpecificIdBytes**

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** id in hex encoding

## StorageEngineInterface

This is a contract for the actual client-specific StorageEngine client has to implement and set to config module.
TinyDb will get the implementation from config module and use it.

**Parameters**

-   `namespace` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** unique namespace will be passed to storage engine when instantiating.
    Values in current instance should be stored under that unique namespace.

### getValue

Asynchronously gets a value from storage.

**Parameters**

-   `key` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** strictly `null` if key or value doesn't exist. TinyDb stores only strings,
so any other return type is an error.

### setValue

Asynchronously saves a value to storage.

**Parameters**

-   `key` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** if key already exists - overwrite.
-   `value` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** TinyDb will serialize any value to string before saving it.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### removeValue

Asynchronously removes key/value from store.

**Parameters**

-   `key` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** if key doesn't exist, just resolve promise.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### getAllKeys

Asynchronously retrieves a list of all keys in current namespace

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>>** 

### clear

Removes all data from current namespace.

## TinyDbManager

TinyDbManager manages system and user collections, and allows opening
other collections.

**Parameters**

-   `createStorageEngine`  

### system

Instance of unencrypted system collection.

Type: TinyDbCollection

### user

Instance of encrypted user collection.
Only values are encrypted.

Type: TinyDb

## errors

Peerio custom error types and error handling helpers.

    // CUSTOM ERROR TEMPLATE
    function CustomError(message, nestedError, otherData) {
      var error = Error.call(this, message);
      this.name = 'CustomError';
      this.message = error.message;
      this.stack = error.stack;
      this.nestedError = nestedError;
      this.otherData = otherData;
    }

    CustomError.prototype = Object.create(Error.prototype);
    CustomError.prototype.constructor = CustomError;

### normalize

Use this helper to resolve returning error value.
If you:

-   have an error result from catch() or reject()
-   don't know what exactly that result is, Error, string, undefined or something else
-   don't need custom errors just want to generate meaningful Error object

Call normalize and pass the result you've got together with fallback message,
that will be wrapped in Error object and returned in case the result wasn't instance of Error

**Parameters**

-   `error` **any** anything you received as an error via catch
-   `failoverMessage` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** if error will not be of Error instance, this message wrapped in new Error object
    will be returned

Returns **[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)** 

### getGenericCustomError

Helper function to create custom errors with less code.
It's useful when your custom error only expects to have an optional `message` and `data` object arguments.

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** custom error name, should match the class name you will use for the error
-   `msg` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** default message for the error

Returns **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** class, inherited from Error

### serverErrorCodes

Check sources for the list of codes.
You can look up this enum both by integer code and by string error name.

### ServerError

Server error, socket throws it when server returns error.

**Parameters**

-   `code` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** server error code
-   `msg` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** message, if any

Returns **ServerError** 

## extensions/uint8array

Uint8Array extensions and polyfills.

### slice

**Extends Uint8Array**

Returns a new Uint8Array containing a portion of current array defined by parameters.

**Parameters**

-   `begin` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** starting index in the original array.
    Can be negative to mark position counting from the end the array. (optional, default `0`)
-   `end` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** ending index (exclusive) in the original array.
    Can be negative to mark position counting from the end the array. (optional, default `this.length`)

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** new array containing a range of bytes from original array.

## ArrayStream

Provides access to array of Uint8Array chunks of data in a stream fashion.
Currently supports only reading from stream.
Underlying array can receive new data by appending(pushing) chunks to it

**Parameters**

-   `array` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)>** 

### peek

Get a portion of data from the stream without consuming it (moving stream pointer)

**Parameters**

-   `size` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)?** 

### read

Read a chunk of data from stream.

**Parameters**

-   `size` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** amount of bytes to read.
-   `adjust` **bool?** default: true. Will consume data read from stream (move pointer). (optional, default `true`)

Returns **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)?** array of requested size. If there's not enough
data to fill array of requested size - null will be returned.

### length

Current stream length (from current position to the end of stream)

Returns **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** available byte length

## helpers/file

Various file helpers

### getFileName

Extracts file name+extension portion from any path.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** file name and extension without any parent folders.

### getFileNameWithoutExtension

Extracts file name without extension from any path

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** file name without extension

### getFileExtension

Extracts file extension from any path.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** file extension

## MRUList

Base class for any Most Recently Used implementations.
Gotcha: Don't create 2+ instances for the same list name. Due to caching it will lead to conflicts.

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** unique name for the list
-   `limit` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)?** maximum number of elements in the list (will remove least recent) (optional, default `10`)

### list

Observable list of current MRU list. Readonly.

Type: ObservableArray&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### loadCache

Loads cached list from current user's TinyDb.
Normally you call this once, after user has been authenticated.
In case an instance is created before that, loadCache() is not called automatically.

### addItem

Adds item usage fact to the list. Saves it to TinyDb in a throttled manner.

**Parameters**

-   `item` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

## Clock

Observable clock.
Provides clock.now property that is mobx observable and changes at specified time interval.
Doesn't tick when no one is observing.
Create your own clock or use default one.

**Parameters**

-   `interval` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** clock update interval in seconds

### now

Current timestamp. Observable. Updates every `this.interval` seconds

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### dispose

Stops the clock, it can't be restarted after this.

### default

Default clock instance with `config.observableClockEventFrequency` interval

Type: [Clock](#clock)

## Timer

Observable timer counter up/down.

### counter

Observable counter you want to watch.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### countUp

Starts counting from 0 to passed seconds amount, updates every second.

**Parameters**

-   `seconds` **any** number of seconds to count to

### countDown

Starts counting from passed seconds amount to 0, updates every second.

**Parameters**

-   `seconds` **any** number of seconds to count from

### stop

Stops counting and resets counter to 0

## Queue

Observable task queue implementation

**Parameters**

-   `parallelism` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** how many tasks can run(wait to be finished) at the same time (optional, default `1`)
-   `throttle` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** how many milliseconds delay to make before running every task (optional, default `0`)

### tasks

List of tasks in queue. Running tasks are not here.

Type: ObservableArray&lt;[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)>

### runningTasks

Amount of currently running tasks

Type: Observable&lt;[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)>

### length

Amount of currently running tasks + tasks in queue

Type: Computed&lt;[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)>

### addTask

Adds task to the queue.
Depending on return value task will be considered finished right after exit from the function or
after returned promise is fulfilled.

**Parameters**

-   `task` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** function to run
-   `context` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)?** 'this' context to execute the task with
-   `args` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>?** arguments to pass to the task
-   `onSuccess` **callback?** callback will be executed as soon as task is finished without error
-   `onError` **callback&lt;[Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)>?** callback will be executed if task throws or rejects promise

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## helpers/system-messages

Helpers for dealing with chat system messages. For UI use.

Some chat messages are in fact sent automatically by client and instead of text they carry special systemData codes.
We don't want clients to repeat handling logic of those codes when system message has to be rendered, this
module should be used instead.

### getSystemMessageText

Checks message object for system data and returns translated string to render for the system data.

**Parameters**

-   `msg` **[Message](#message)** 

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** translated string to render for this system message

## helpers/field-validation

### addValidation

Takes an observable store for a form, a field name, as well as validators
and an optional position of the field relative to the form, and
attaches validation handlers and triggers for validation.

onChange and onBlur handlers must be manually attached to the input
in peerio-desktop, the ValidatedInput can be used

**Parameters**

-   `store` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
-   `fName` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** field name
-   `validatorOrArray` **([Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)> | [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object))** 
-   `positionInForm` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)?** 

## helpers/user-validators

## index

In addition to exporting public API, entry point, when first required,
performs some global configuration such as:

-   replaces global Promise object with bluebird implementation. Note that native(not transpiled) async functions
    will still return native Promise.
-   extends Uint8Array prototype. See [extensions/uint8array](#extensionsuint8array).

## ChatHead

**Extends SyncedKeg**

Chat head keg is open for any chat participant to update.

**Parameters**

-   `db` **[ChatKegDb](#chatkegdb)** 

### chatName

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### purpose

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

## ChatInviteStore

Chat invites store. Contains lists of incoming and outgoing invites and operations on them.

### received

List of channel ids current user has been invited to.

Type: ObservableArray&lt;{kegDbId: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String), username: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String), timestamp: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)}>

### sent

List of channel invites admins of current channel have sent.

### acceptInvite

**Parameters**

-   `kegDbId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### rejectInvite

**Parameters**

-   `kegDbId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### revokeInvite

**Parameters**

-   `kegDbId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `noWarning`   (optional, default `false`)

## ChatStore

Chat store.

### events

Currently emits just one event - 'messagesReceived' (1 sec. throttled)

Type: EventEmitter

### chats

Working set of chats. Server might have more, but we display only these at any time.

Type: ObservableArray&lt;[Chat](#chat)>

### unreadChatsAlwaysOnTop

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### loading

True when chat list loading is in progress.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### activeChat

currently selected/focused chat.

Type: [Chat](#chat)

### hidingChat

Chats set this flag and UI should use it to prevent user from spam-clicking the 'hide' button

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### loaded

True when loadAllChats() was called and finished once already.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### unreadMessages

Total unread messages in all chats.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### directMessages

Subset of ChatStore#chats, contains only direct message chats

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Chat](#chat)>

### channels

Subset of ChatStore#chats, contains only channel chats

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Chat](#chat)>

### hasChannels

Does chat store has any channels or not.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### loadAllChats

Initial chats list loading, call once after login.

Logic:

-   load all favorite chats
-   see if we have some limit left and load other unhidden chats
-   see if digest contains some new chats that are not hidden

ORDER OF THE STEPS IS IMPORTANT ON MANY LEVELS

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### startChat

Starts new chat or loads existing one and

**Parameters**

-   `participants` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>?** 
-   `isChannel` **bool?** 
-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** 
-   `purpose` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** only for channels, not relevant for DMs

Returns **[Chat](#chat)?** can return null in case of paywall

### activate

Activates the chat.

**Parameters**

-   `id` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** chat id

### deactivateCurrentChat

Deactivates currently active chat.

### startChatAndShareFiles

Can be used from file view.

**Parameters**

-   `participants` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>** 
-   `fileOrFiles` **([File](#file) \| [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[File](#file)>)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### unloadChat

Removes chat from working set.

**Parameters**

-   `chat` **[Chat](#chat)** 

## addChat

Adds chat to the list.

**Parameters**

-   `chat` **([string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Chat](#chat))** chat id or Chat instance
-   `unhide` **bool** this flag helps us to force unhiding chat when we detected that addChat was called as
    a result of new messages in the chat (but not other new/updated kegs)

## ChatFileHandler

File handling module for Chat. Extracted for readability.

**Parameters**

-   `chat` **[Chat](#chat)** chat creates an instance and passes itself to it.

### uploadAndShare

Initiates file upload and shares it to the chat afterwards.
Note that if app session ends before this is done - files will be only uploaded by resume logic.
But chat message will not be sent.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** full file path
-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** override file name, specify to store the file keg with this name
-   `deleteAfterUpload` **bool** delete local file after successful upload (optional, default `false`)

Returns **[File](#file)** 

## Chat

at least one of two arguments should be set

**Parameters**

-   `id` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** chat id
-   `participants` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>** chat participants, will be used to create chat or find it by participant list (optional, default `[]`)
-   `store` **[ChatStore](#chatstore)** 
-   `isChannel` **bool?**  (optional, default `false`)

### id

Chat id

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?

### messages

Render these messages.

Type: ObservableArray&lt;[Message](#message)>

### limboMessages

Render these messages at the bottom of the chat, they don't have Id yet, you can use tempId.

Type: ObservableArray&lt;[Message](#message)>

### participants

Does not include current user. Includes participants that are just invited but not joined too.

Type: ObservableArray&lt;[Contact](#contact)>

### participants

Does not include current user. Includes participants that are just invited but not joined too.

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>

### loadingMeta

If true - chat is not ready for anything yet.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### metaLoaded

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### loadingInitialPage

This can happen when chat was just added or after reset()

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### initialPageLoaded

Ready to render messages.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### mostRecentMessageLoaded

Ready to render most recent message contents in chat list.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### loadingTopPage

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### loadingBottomPage

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### canGoUp

can we go back in history from where we are? (load older messages)

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### canGoDown

can we go forward in history or we have the most recent data loaded

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### active

currently selected/focused in UI

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### active

Is this chat instance added to chat list already or not

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### isFavorite

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### changingFavState

Prevent spamming 'Favorite' button in GUI.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### leaving

Will be set to `true` after leave() is called on the channel so UI can react until channel is actually removed.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### uploadQueue

list of files being uploaded to this chat.

Type: ObservableArray&lt;[File](#file)>

### unreadCount

Unread message count in this chat.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### newMessagesMarkerPos

when user is not looking but chat is active and receiving updates,
chat briefly sets this value to the id of last seen message so client can render separator marker.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### chatHead

Chat head keg.
Observable, because `this.name` relies on it

Type: [ChatHead](#chathead)?

### isReadOnly

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### participantUsernames

Excluding current user.

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### name

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### purpose

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### canSendAck

User should not be able to send multiple ack messages in a row. We don't limit it on SDK level, but GUIs should.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### showNewMessagesMarker

Don't render message marker if this is false.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### canIAdmin

True if current user is an admin of this chat.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### canILeave

True if current user can leave the channel. (Last admin usually can't)

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### mostRecentMessage

Type: [Message](#message)?

### removeMessage

todo: this is temporary, for messages that failed to send.
When we have message delete - it should be unified process.

**Parameters**

-   `message` **[Message](#message)** 

### sendAck

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### uploadAndShareFile

Note that file will not be shared if session ends, but it will be uploaded because of upload resume logic.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** 
-   `deleteAfterUpload` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**  (optional, default `false`)

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### shareFiles

**Parameters**

-   `files` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[File](#file)>** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### loadPreviousPage

### loadNextPage

### rename

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** pass empty string to remove chat name

### changePurpose

**Parameters**

-   `purpose` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** pass empty string to remove chat purpose

### reset

Reloads most recent page of the chat like it was just added.

### delete

Deletes the channel.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### addParticipants

Adds participants to a channel.

**Parameters**

-   `participants`  
-   `null-null` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;([string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Contact](#contact))>** mix of usernames and Contact objects.
                                     Note that this function will ensure contacts are loaded before proceeding.
                                     So if there are some invalid contacts - entire batch will fail.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### promoteToAdmin

Assigns admin role to a contact.

**Parameters**

-   `contact` **[Contact](#contact)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### demoteAdmin

Unassigns admin role from a contact.

**Parameters**

-   `contact` **[Contact](#contact)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### isAdmin

Checks if a contact has admin rights to this chat.

**Parameters**

-   `contact` **[Contact](#contact)** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

### removeParticipant

Removes participant from the channel.

**Parameters**

-   `participant` **([string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Contact](#contact))** 
-   `isUserKick` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** this function is called in case admin kicks the user and in case user left and
                                   admin needs to remove their keys. Method wants to know which case is it. (optional, default `true`)

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### leave

Remove myself from this channel.

## toggleFavoriteState

## hide

## unhide

## Message

**Extends Keg**

Message keg and model

**Parameters**

-   `db` **[ChatStore](#chatstore)** chat db

### sending

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### sendError

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### receipts

array of usernames to render receipts for

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### userMentions

Which usernames are mentioned in this message.

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### firstOfTheDay

Is this message first in the day it was sent (and loaded message page)

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### groupWithPrevious

whether or not to group this message with previous one in message list.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### inlineImages

for UI use

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### dayFingerprint

used to compare calendar days

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### messageTimestampText

TODO: mobile uses this, but desktop uses
TODO: new Intl.DateTimeFormat(undefined, { hour: '2-digit', minute: '2-digit' });
TODO: resolve/unify this in favor of most performant method

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

## sender

Type: [Contact](#contact)

## text

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

## systemData

For system messages like chat rename fact.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

## timestamp

Type: [Date](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date)

## files

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

## isMention

Does this message mention current user.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

## MyChats

**Extends SyncedKeg**

MyChats keg holds chat groups for user.

### favorites

Favorite chat ids

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### hidden

Hidden chat ids

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### addFavorite

Adds favorite chat and removes it from hidden list if it was there.

**Parameters**

-   `chatId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** true if added, false if already had been in the list

### removeFavorite

Removes favorite chat,

**Parameters**

-   `chatId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** true if removed, false if couldn't find it in the favorites list

### addHidden

Adds hidden chat and removes it from favorites list if it was there.

**Parameters**

-   `chatId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** true if added, false if already had been in the list

### removeHidden

Removes hidden chat.

**Parameters**

-   `chatId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** true if removed, false if couldn't find it in the hidden list

## ReadReceipt

**Extends Keg**

Holds read position (kegId) for a user in a chat. Named keg, names contain usernames.

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `db` **[ChatKegDb](#chatkegdb)** 

### chatPosition

Id of the last read message

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### receiptError

true if this receipt's name doesn't match keg owner.

Type: bool

## ClientApp

This is the place where Icebear can get various state information about client
and client can provide such information.

### isFocused

Set this flag when to help Icebear know if user is currently interacting with your app or not.
One example of how this affects Icebear behavior:
messages will not be marked as 'read' unless isFocused == true

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### isInChatsView

Use this to let Icebear know if your app is currently showing any of the chats.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### isInFilesView

Use this to let Icebear know if your app is currently showing main file view.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### clientVersionDeprecated

Icebear sets this flag.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

## active2FARequest

UI should listen to this and request entering of 2fa code from user and then pass ot back to icebear.

Type: [TwoFARequest](#twofarequest)

## ContactStore

Contact store handles all Peerio users you(your app) are in some contact with,
not just the ones you add to favorites explicitly.

### contacts

All peerio users your app encounters end up here (except invited by email, they're non-peerio users).

Type: ObservableArray&lt;[Contact](#contact)>

### addedContacts

Favorite Contacts.

Type: ObservableArray&lt;[Contact](#contact)>

### invitedContacts

Invited contacts.

Type: ObservableArray&lt;InvitedContacts>

### uiViewSortBy

options: firstName, lastName, username

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### uiViewFilter

options: added, all

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### uiViewSearchQuery

Any string to search in user's names.
Set to `''` to clear search.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### uiView

Helper data view to simplify sorting and filtering.

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;{letter: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String), items: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>}>

### addContact

Tries to add contact to favorites.

**Parameters**

-   `val` **([string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Contact](#contact))** username, email or Contact

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;bool>** true: added, false: not found

### addContactBatch

Accepts array of preloaded contacts, and adds them to favorites.
WARNING: doesn't not wait for passed contacts to load.

**Parameters**

-   `contacts` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### importContacts

Looks up by email and adds contacts to favorites list.

**Parameters**

-   `emails` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** 

Returns **{imported: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>, notFound: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>}** 

### removeContact

Removes contact from favorites.

**Parameters**

-   `usernameOrContact` **([string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Contact](#contact))** 

### removeInvite

Removes invitation.

**Parameters**

-   `email` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### removeReceivedInvite

Removes incoming invitation. This is useful for new users, logic automatically adds authors of received invites
to favorites and then removes received invites.

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### getContact

Returns Contact object ether from cache or server.
It is important to be aware about `loading` state of contact, it is not guaranteed it will be loaded
after this function returns contact.

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `prefetchedData` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)?** 

Returns **[Contact](#contact)** 

### invite

Sends an invite

**Parameters**

-   `email` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### filter

Filters contacts by username and First Last name based on passed token

**Parameters**

-   `token` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** search query string
-   `list` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>** optional list to search in, by default it will search in contact store
-   `nosort`   (optional, default `false`)

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>** 

## Contact

Contact object represents any Peerio user, including currently authenticated user.

Possible states and how to read them:
loading === true - trying to load contact, will make many attempts in case of connection issues
loading === false && notFound === false - success
loading === false && notFound === true  - fail

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** this can also be an email which will be replaced with username if user found
-   `prefetchedData` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)?** if, for some reason you have the contact data from server, feed it here
-   `noAutoLoad` **bool?** don't automatically call this.load() in constructor (needed for tests only)

### loading

This flag means that we are making attempts to load contact
once it's 'false' it means that we are done trying with ether positive (notFound=false) result
or negative result. It's set to true by default, right after it exits constructor.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### username

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### usernameTag

'@username'

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### firstName

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### lastName

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### encryptionPublicKey

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

### signingPublicKey

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

### tofuError

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### isAdded

Wether or not user added this contact to his address book

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### urlSalt

Some server-generated random chars to prevent enumeration of user-specific urls

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### profileVersion

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### hasAvatar

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### isDeleted

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### color

RGB string built based on hashed signing public key, not cryptographically strong, just for better UX

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### letter

First letter of first name or username.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### fullName

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### fullNameAndUsername

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### fullNameLower

Lower cased full name for search/filter optimization

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### fingerprint

Cryptographically strong User fingerprint based on signing public key.
Looks like '12345-12345-12345-12345-12345', empty value is '00000-00000-00000-00000-00000-00000'

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### largeAvatarUrl

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### mediumAvatarUrl

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### fingerprintSkylarFormatted

Same as [fingerprint](fingerprint), but formatted as: '1234 5123 4512\\n3451 2345 1234 5123 45'

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### notFound

Server said it couldn't find this user.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### isLegacy

Legacy contacts can't be used so they should treated as 'notFound' but clients can inform user about legacy
contact pending migration if this flag is `true` after loading is done.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### load

Loads user data from server (or applies prefetched data)

**Parameters**

-   `prefetchedData` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)?** 

### whenLoaded

Helper function to execute callback when contact is loaded.
Executes immediately if already loaded.

**Parameters**

-   `callback` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

### ensureLoaded

Helper function to get a promise that resolves when contact is loaded.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### ensureAllLoaded

Helper function to get a promise that resolves when all contacts in passed collection are loaded.

**Parameters**

-   `contacts` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## Invites

**Extends SyncedKeg**

Named readonly server-controlled keg. Contains data about contacts invited by email.
Invite data can be modified via separate api.

### issued

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[InvitedContact](#invitedcontact)>

## Tofu

**Extends Keg**

Tofu keg.

**Parameters**

-   `db` **[KegDb](#kegdb)** 

### username

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### firstName

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### lastName

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### encryptionPublicKey

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

### signingPublicKey

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

### getByUsername

Finds Tofu keg by username property.

**Parameters**

-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Tofu](#tofu)?>** tofu keg, if any

## FileStore

File store.

### files

Full list of user's files.

Type: ObservableArray&lt;[File](#file)>

### loading

Store is loading full file list for the first time.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### currentFilter

Readonly, shows which keyword was used with last call to `filter()`, this need refactoring.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### updating

Currently updating file list from server, this is not observable property.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### uploadQueue

Readonly

Type: [Queue](#queue)

### hasSelectedFiles

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### canShareSelectedFiles

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### allVisibleSelected

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### selectedCount

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### getSelectedFiles

Returns currently selected files (file.selected == true)

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[File](#file)>** 

### getShareableSelectedFiles

Returns currently selected files that are also shareable.

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[File](#file)>** 

### clearSelection

Deselects all files

### selectAll

Selects all files

### deselectUnshareableFiles

Deselects unshareable files

### filterByName

Applies filter to files.

**Parameters**

-   `query` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### clearFilter

Resets filter

### loadAllFiles

Call at least once from UI.

### getById

Finds file by fileId.

**Parameters**

-   `fileId` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[File](#file)?** 

## upload

Start new file upload and get the file keg for it.

**Parameters**

-   `filePath` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** full path with name
-   `fileName` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** if u want to override name in filePath

## FileStreamAbstract

Abstract File Stream class. Icebear wants to read/write files,
but doesn't know how exactly that would work on your platform.

1.  create you own class and inherit from FileStreamAbstract.
2.  override required functions.
3.  set config.FileStream = YourFileStreamImplementation.

**Parameters**

-   `filePath` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** will be used by 'open' function
-   `mode` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 'read' or 'write' or 'append'

### filePath

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### mode

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### pos

File stream pointer

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### open

Override. This function has to set 'size' property.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[FileStreamAbstract](#filestreamabstract)>** this

### close

Override. Called when done working with file, should flush all buffers and dispose resources.

### getFullPath

Override. Returns full path for file when there's a default cache path implemented in the app.
Currently only mobile.

**Parameters**

-   `uid` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** unique identifier
-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** human-readable file name

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** actual device path for file

### exists

Override.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)>** true if path exists on device

### launchViewer

Override. Launch external viewer.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** file path to open in a viewer.

### getStat

Override. Get file stat object.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **{size: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)}** 

### getCacheList

Override. Currently mobile only.

Returns **any** Promise&lt;string\[]> - array of absolute paths to cached items.

### delete

Override. Removes file by path.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## read

Reads a chunk of data from file stream.

**Parameters**

-   `size` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** amount of bytes to read (if possible)

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)>** resolves with a number of bytes written to buffer

## write

Writes a chunk of data to file stream

**Parameters**

-   `buffer` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** resolves when chunk is written out

## seek

Move file position pointer.

**Parameters**

-   `pos` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

Returns **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** new position

## File

**Extends Keg**

File keg and model.

**Parameters**

-   `db` **[KegDb](#kegdb)** 

### download

Starts download.

**Parameters**

-   `filePath` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** where to store file (including name)
-   `resume` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?** for system use

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### cancelDownload

Cancels download and removes impartially downloaded file.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### key

Blob key

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

### nonce

Blob nonce. It's separate because this is a base nonce, every chunk adds its number to it to decrypt.

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

### fileId

System-wide unique client-generated id

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### name

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### size

Bytes

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### uploadedAt

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### fileOwner

Username uploaded this file.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### readyForDownload

When this is 'true' file is ready to be downloaded. Upload finishes before that,
then server needs some time to process file.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### uploading

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### downloading

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### progress

Upload or download progress value in bytes. Note that when uploading it doesn't count overhead.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### progressMax

File size with overhead for downloads and without overhead for uploads.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### cached

currently mobile only: flag means file was downloaded and is available locally

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### selected

Is this file selected in file pickers for group operations.
It's a bit weird mix of UI state and logic, but it works fine at the moment,
we'll rethink it when we implement folders.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### show

Is this file visible or filtered by search. Also weird, needs refactor.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### uploadCancelled

If upload cancel is initiated by user

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### shared

Is this file currently shared with anyone.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### ext

file extension

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### cachePath

currently mobile only: Full path to locally stored file

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### sizeFormatted

Human readable file size

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### chunksCount

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### canShare

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### sizeWithOverhead

Bytes

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### share

Share file with contacts

**Parameters**

-   `contactOrContacts` **([Contact](#contact) \| [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)> | ObservableArray&lt;[Contact](#contact)>)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### launchViewer

Open file with system's default file type handler app.

**Parameters**

-   `path` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** tries this.cachePath if path is not passed

### deleteCache

Remove locally stored file copy. Currently only mobile uses this.

### remove

Remove file from cloud and unshare with everyone.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### rename

Safe to call any time after upload has been started (keg created).
Retries a few times in case of error.

**Parameters**

-   `newName` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### upload

Starts file upload.

**Parameters**

-   `filePath` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `fileName` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** if you'd like to override this.name or filePath
-   `resume` **bool?** system sets this param to true when it detects unfinished upload

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### cancelUpload

Cancels ongoing upload. This will also remove file keg.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## NodeFileStream

**Extends FileStreamAbstract**

FileStreamAbstract implementation for nodejs, see [FileStreamAbstract](#filestreamabstract) for docs.

## BootKeg

**Extends Keg**

Named plaintext Boot keg for 'SELF' databases.

**Parameters**

-   `db` **[KegDb](#kegdb)** owner instance
-   `bootKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 

### signKeys

Type: [KeyPair](#keypair)

### encryptionKeys

Type: [KeyPair](#keypair)

### kegKey

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

## ChatBootKeg

**Extends SyncedKeg**

Named plaintext Boot keg for shared keg databases.

Payload format version 1:

    {
      publicKey: b64 encoded buffer,
      encryptedKeys: {
              username: b64 encoded buffer, // encrypted for user's PK
              username1: b64 encoded buffer
            }
    }

Payload format version 2:

    {
      publicKey: b64 encoded buffer, // public key from the encrypting ephemeral pair
      roles: {
         admin: ["username", "username1", ...],
         some_role_we_will_want_later: ["username"]
      },
      // object key = incremental key id
      encryptedKeys: {
         "0": {
                 createdAt: number
                 keys: {
                    // key id
                    username: {
                        key: b64 encoded buffer, // encrypted for user's PK
                        publicKey: b64 encoded buffer // user's public key (so user can still
                                                      // decrypt this after she changes her keys)
                    }
                    username1: {...}
                 }
              },
         "1": {
              ...
            }
      }
    }

1.  Adding someone to the chat with full history access
    -   Create new 'username:encryptedKey' record in the most ALL key object
    -   for this generate new ephemeral key pair, and re-encrypt all the stuff
    -   Send a system message 'username was invited'
        At this point, invited user has full normal access to this keg db, BUT doesn't receive any notifications
        push or keg notifications. As user now has full access to the keg db she will infer invitation status
        from the special keg described below.
2.  Revoking invite or removing user from the channel
    -   Delete the record for this user from ALL keys
    -   Server deletes invite_status-username keg
3.  Accepting an invitation
    -   invited user creates/undeletes invite_status-username keg with accepted:true property in it
        Server enables notifications when joined:true.
4.  Leaving a channel
    -   participant sets joined:false
    -   admin removes user from boot keg

invite_status keg

    {
      accepted: boolean
    }

**Parameters**

-   `db` **[KegDb](#kegdb)** owner instance
-   `user` **[User](#user)** currently authenticated user

### participants

List of usernames who have access to the chat currently.
This includes users pending join confirmation.

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>

### admins

Subset of `this.participants`.

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>

### addParticipant

Gives access to chat keys to a contact.

**Parameters**

-   `contact` **[Contact](#contact)** 

### removeParticipant

Gives access to chat keys to a contact.

**Parameters**

-   `contact` **[Contact](#contact)** 

## ChatKegDb

Class for shared keg databases.
Chat is not really created until boot keg is updated for the first time.
Multiple people might try to create boot keg for the same chat at the same time.
We have a special logic to resolve this kind of situations.

ChatKegDb is similar to [KegDb](#kegdb) in a sense that it has same `id`, `boot` and `key`
properties, but the logic is too different to extract a base class. Although when saving and loading Kegs,
you can use both databases, the properties mentioned is all Kegs can care about.

Chat loading logic // todo: update this with channels logic modifications

    retryUntilSuccess(
    1. Do we have ID for the chat?
    - 1.1 NO:
         - create-chat
         - if resolved: now we have chat meta data, GOTO (2.)
         - if rejected: retry is triggered
    - 1.2 YES:
         - get metadata
         - if resolved: now we have chat meta data, GOTO (2.)
         - if rejected: retry is triggered
    2. Parse chat metadata
    3. Does boot keg exist? (load it and check if keg version > 1)
    - 3.1 YES:
         - load boot keg
         - resolved: is it valid ?
             - YES: FINISH. Promise.resolve(true)
             - NO: FINISH. Promise.resolve(false) for retry to not trigger
         - rejected: retry is triggered
    - 3.2 NO:
         - create boot keg.
             - resolved: FINISH. Promise.resolve(true)
             - rejected: retry is triggered
    - 3.3 load failed: retry is triggered
    , 'Unique retry id')

At least one of 2 parameters should be passed

**Parameters**

-   `id` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** or specific id for shared databases
-   `participants` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>?** participants list, EXCLUDING own username (optional, default `[]`)
-   `isChannel` **bool** does this db belong to a DM or Channel (optional, default `false`)

### id

System-wide unique database id generated by server

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### key

Database key to use for keg encryption.

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)?

### keyId

Current key id for the database

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?

### boot

Type: [BootKeg](#bootkeg)

### participants

Just a mirror of this.boot.participants

Type: ObservableArray&lt;[Contact](#contact)>

### admins

Just a mirror of this.boot.admins

Type: ObservableArray&lt;[Contact](#contact)>

### participantsToCreateWith

All participants except current user.
This will be used to create chat, if passed.
For DMs create operation will return existing chat.

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Contact](#contact)>

### dbIsBroken

if true - something is wrong with boot keg, most likely it was maliciously created and can't be used

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### isChannel

Is this a channel or DM db.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

## KegDb

Keg database.
This class is for user's own database ('SELF')

### id

Always equals 'SELF'

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### key

Database key to use for keg encryption.

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

### keyId

Current key id for the database

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?

### boot

Type: [BootKeg](#bootkeg)

## Keg

Base class with common metadata and operations.

**Parameters**

-   `id` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** kegId, or null for new kegs
-   `type` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** keg type
-   `db` **[KegDb](#kegdb)** keg database instance owning this keg
-   `plaintext` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** should keg be encrypted (optional, default `false`)
-   `forceSign` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** plaintext kegs are not normally signed unless forceSign is true (optional, default `false`)
-   `allowEmpty` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** normally client doesn't expect empty keg when calling `.load()` and will throw (optional, default `false`)
-   `storeSignerData` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** if the keg is signed, in addition to signature it will store
                                               and then verify over signedByUsername prop instead of `keg.owner`. (optional, default `false`)

### type

Keg type

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### db

Owner KegDb instance

Type: [KegDb](#kegdb)

### plaintext

Is the payload of this keg encrypted or not

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### overrideKey

Sometimes this specific key has to be en/decrypted with other then default for this KegDb key.

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)?

### version

Keg version, when first created and empty, keg has version === 1

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### format

Keg format version, client tracks kegs structure changes with this property

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### collectionVersion

Keg collection (all kegs with this.type) version, snowflake string id.
null means we don't know the version yet, need to fetch keg at least once.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?

### props

Default props object for default props serializers. More advanced logic usually ignores this property.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

### forceSign

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### allowEmpty

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### storeSignerData

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### signatureError

null when signature has not been verified yet (it's async) or it will never be because this keg is not supposed
to be signed.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?

### sharedKegError

Indicates failure to process received/shared keg.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?

### id

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?

### tempId

If this keg wasn't created yet, but you need to use it in a list somewhere like chat, you can call
`assignTempId()` and use this field as identification.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?

### deleted

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### loading

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### saving

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### dirty

Subclasses can set this to 'true' on data modification and subscribe to the flag resetting to 'false'
after keg is saved.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### lastLoadHadError

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### isEmpty

Kegs with version==1 were just created and don't have any data

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

### assignTemporaryId

Creates unique (for session) temporary id and puts it into `tempId`

### saveToServer

Saves keg to server, creates keg (reserves id) first if needed

**Parameters**

-   `cleanShareData` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** removes shared/sent keg metadata that is not needed after keg is re-encrypted.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### load

(Re)populates this keg instance with data from server

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Keg](#keg)>** 

### remove

Deletes the keg.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### loadFromKeg

Synchronous function to rehydrate current Keg instance with data from server.
`load()` uses this function, you don't need to call it if you use `load()`, but in case you are requesting
multiple kegs from server and want to instantiate them use this function
after creating appropriate keg instance.

**Parameters**

-   `keg` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** data as received from server

Returns **([Keg](#keg) \| [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean))** returns false if keg data could not have been loaded. This function doesn't throw,
you have to check error flags if you received false return value.

### serializeKegPayload

Generic version that provides empty keg payload.
Override in child classes to.

Returns **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

### deserializeKegPayload

Generic version that does nothing.
Override in child classes to convert raw keg data into object properties.

**Parameters**

-   `payload`  

### serializeProps

Generic version that uses this.props object as-is

Returns **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

### deserializeProps

Generic version that puts props object as-is to this.prop

**Parameters**

-   `props` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

## SyncedKeg

**Extends Keg**

This class allows named kegs to share sync/save logic.
This is for named kegs only! Named kegs assume there's just one instance of it.

**Parameters**

-   `kegName` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** kegName === kegType currently
-   `db` **([KegDb](#kegdb) \| [ChatKegDb](#chatkegdb))** this keg owner database
-   `plaintext` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** encrypted or not (optional, default `false`)
-   `forceSign` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** force signature of plaintext kegs or not (optional, default `false`)
-   `allowEmpty`   (optional, default `true`)
-   `storeSignerData`   (optional, default `false`)

### loaded

Sets to true when keg is loaded for the first time.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### reload

Forces updating keg data from server

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### save

Enqueues Save task.

**Parameters**

-   `dataChangeFn` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)&lt;bool>** function that will be called right before keg save,
    it has to mutate keg's state. Return false to cancel save.
-   `dataRestoreFn` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)?** function that will be called to restore keg state to the point before
    dataChangeFn mutated it. Default implementation will rely on keg serialization functions. dataRestoreFn will only
    get called if version of the keg didn't change after save failed. This will make sure we won't overwrite
    freshly received data from server.
-   `errorLocaleKey` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** optional error to show in snackbar

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## PhraseDictionary

Passphrase dictionary module.

**Parameters**

-   `locale` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** locale code for dict
-   `dictString` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** '\\n' separated word list

### getPassphrase

Returns a random passphrase of chosen word length

**Parameters**

-   `length` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** passphrase word count

### dispose

Free RAM by removing cached dictionary

### current

Last chosen dictionary.

Type: [PhraseDictionary](#phrasedictionary)

### setDictionary

Simple management of dictionaries: this function sets the PhraseDictionary.current property so it's accessible
whenever you need without re-creating the dictionary every time.

**Parameters**

-   `localeCode` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `rawData` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

## ServerSettings

Some client configuration details can't be hardcoded to clients or stored in every user database.
This module takes care of these settings by loading them from server every time client connects.
There's no need for 'updated' events from server because when these settings change server always resets connection.

### avatarServer

Observable base url for avatars https service

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### acceptableClientVersions

Observable client version range this server can work with.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### tag

Observable git tag for this server build

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

## NodeJsonStorage

This is a StorageEngine implementation that can be used in any nodejs-based apps (cli, electron).

It uses os.homedir() or NodeJsonStorage.storageFolder to store JSON files.

**Parameters**

-   `name`  

## Settings

**Extends Keg**

Plaintext named system keg, server controlled.
User can update this keg, but server verifies contract.

**Parameters**

-   `user` **[User](#user)** 

### contactNotifications

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### contactRequestNotifications

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### messageNotifications

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### errorTracking

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### dataCollection

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### subscribeToPromoEmails

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

## User

Class represents application user, you have to create and instance and assign it to `User.current`
on sign in. All systems depend on `User.current` to be set at the moment socket is authenticated.

User has a lot of members and they all appear to be in the same place in documentation, but in sources
members are grouped by theme in several files. That said, User class and registration/authentication code
specifically requires refactoring to improve readability and reduce state-mutating functions amount.

Many private and protected members are not documented with jsdoc tags to avoid clutter.

### setup2fa

Starts 2fa setup challenge.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>** TOTP secret

### confirm2faSetup

Finishes 2fa setup challenge

**Parameters**

-   `code` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `trust` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** wether or not to trust this device and minimize 2fa requests on login (optional, default `false`)

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>>** backup codes

### disable2fa

Disables 2fa on current account.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### reissueBackupCodes

Requests new set of 2fa backup codes invalidating previous ones..

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### serializeAuthData

Creates an object with key authentication data that can be used for login
with minimal time waste on key derivation.
You can use this to store auth data locally in keychain or protected with shorter password.

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### deserializeAuthData

Applies serialized auth data to user object. Just call `login()` after this and user will get authenticated
faster then when you just provide username and passphrase.

**Parameters**

-   `data` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### disablePasscode

Removes passcode for a user if it exists, and disables using passcodes.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### passcodeIsDisabled

Checks if user disabled passcode.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)>** 

### setPasscode

Given a passcode and a populated User model, gets a passcode-encrypted
secret containing the username and passphrase as a JSON string and stores
it to the local db.

**Parameters**

-   `passcode` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### validatePasscode

Validates passcode.

**Parameters**

-   `passcode` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)>** 

### hasPasscode

Checks if user has a passcode saved.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)>** 

### firstName

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### lastName

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### email

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### locale

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### passcodeIsSet

Currently unused, maybe we will bring passcodes back eventually

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### profileLoaded

Sets to `true` when profile is loaded for the first time and is not empty anymore.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### primaryAddressConfirmed

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### deleted

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### blacklisted

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### savingAvatar

Don't try to upload another avatar while this is `true`

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### autologinEnabled

UI-controlled flag, Icebear doesn't use it

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### secureWithTouchID

UI-controlled flag, Icebear doesn't use it

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### twoFAEnabled

Indicates 2fa state on current user.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### fullName

Computed `firstName+' '+lastName`

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### createdAt

Account creation timestamp. Is null until `profileLoaded != true`.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### passphrase

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### authSalt

Type: [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)

### authKeys

Type: [KeyPair](#keypair)

### signKeys

Type: [KeyPair](#keypair)

### encryptionKeys

Type: [KeyPair](#keypair)

### emojiMRU

Most recently used emoji.

Type: [MRUList](#mrulist)

### activePlans

All current active plan names

Type: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>

### fileQuotaTotal

Total amounts of bytes user can upload.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### fileQuotaTotalFmt

Formatted total amounts of bytes user can upload.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### fileQuotaLeft

Free bytes left for uploads.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### fileQuotaLeftFmt

Formatted bytes left for uploads.

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### fileSizeLimit

Maximum file size user can upload.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### fileSizeLimitFmt

Formatted maximum file size user can upload.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### fileQuotaUsed

Used bytes in storage.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### fileQuotaUsedFmt

Formatted used bytes in storage.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### fileQuotaUsedPercent

Amount of % used bytes in storage.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### channelLimit

Maximum number of channels user can have

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### channelsLeft

Available channel slots left.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### maxInvitedPeopleBonus

Maximum amount of people invited which give you bonus

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### currentInvitedPeopleBonus

Maximum amount of people invited which give you bonus

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### maximumOnboardingBonus

Maximum bonus user can achieve if they complete all tasks

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### currentOnboardingBonus

Maximum bonus user can achieve if they complete all tasks

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### canUploadFileSize

Checks if there's enough storage to upload a file.

**Parameters**

-   `size` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** amount of bytes user wants to upload.

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** is there enough storage left to upload.

### canUploadMaxFileSize

Checks if the file size is not too big for the current plan
e.g. Basic - 500 Mb limit, Premium - 2 Gb. Pro - unlimited.

**Parameters**

-   `size` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** amount of bytes user wants to upload.

Returns **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** is file size acceptable for current plan

### createAccountAndLogin

Full registration process.
Initial login after registration differs a little.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### login

Authenticates connection and makes necessary initial requests.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setAsLastAuthenticated

Saves the data of the last authenticated user.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### settings

User settings from settings keg.

Type: [Settings](#settings)

### resendEmailConfirmation

**Parameters**

-   `email` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### removeEmail

**Parameters**

-   `email` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### addEmail

**Parameters**

-   `email` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### makeEmailPrimary

**Parameters**

-   `email` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### saveAvatar

**Parameters**

-   `blobs` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[ArrayBuffer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer)>?** 2 elements, 0-large, 1-medium avatar. Omit parameter
    or pass null to delete avatar

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### deleteAvatar

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### setAccountKeyBackedUp

Notify server that the account key is backed up, so server would give a storage bonus

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### current

Currently authenticated user.

Type: [User](#user)

### getLastAuthenticated

Gets the last authenticated user.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;{username: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String), firstName: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String), lastName: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)}?>** 

### removeLastAuthenticated

Removes last authenticated user information.

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## username

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

## Warnings

Public API for Warnings system.

### add

General method to add warnings. More specialized shortcuts are available.
Severe warnings will always get added to the top of the queue.

**Parameters**

-   `content` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** translation key.
-   `title` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** optional translation key for title, will not be shown in snackbars.
-   `data` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)?** variables to pass to translator.
-   `level` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** severity level. (optional, default `'medium'`)
-   `callback` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)?** executes when warning is dismissed

### addSevere

Shortcut to add severe warnings without specifying severity level explicitly.
Severe warnings will always get added to the top of the queue.

**Parameters**

-   `content` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** translation key.
-   `title` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** optional translation key for title, will not be shown in snackbars.
-   `data` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)?** variables to pass to translator.
-   `callback` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)?** executes when warning is dismissed

### current

Observable. Clients should watch this and render new snackbar/dialog on change.

Type: SystemWarning

## SocketClient

Use socket.js to get the default instance of SocketClient, unless you do need a separate connection for some reason.

SocketClient emits many events, main ones are:

-   **started** - whenever socket.start() is called the first time.
-   **connect** - every time connection has been established.
-   **authenticated** - when connection is fully authenticated and ready to work.
-   **disconnect** - every time connection has been broken.

The rest you can find in sources:

-   **SOCKET_EVENTS** - whatever is happening with socket.io instance
-   **APP_EVENTS** - server emits them

### started

Was socket started or not

### url

Connection url this socket uses. Readonly.

### connected

Observable connection state.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### authenticated

Observable. Normally you want to use socket when it's authenticated rather then just connected.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### throttled

Observable. Is the connection currently throttled by server.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### reconnectAttempt

Observable. In case reconnection attempt failed, this property will reflect current attempt number.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### reconnecting

Observable. Shows if reconnecting process is in progress.

Type: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### latency

Observable. Shows current server response time in milliseconds. This is not a network ping,
this is a time needed for a websocket message to do a round trip.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### reconnectTimer

Countdown to the next reconnect attempt.

Type: [Timer](#timer)

### bytesReceived

Total amount of bytes received since socket was created.
Note that this is not including file downloads, because downloads go through https.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### bytesSent

Total amount of bytes sent since socket was created.

Type: [number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)

### STATES

Possible connection states

### SOCKET_EVENTS

Socket lifecycle events

### APP_EVENTS

Application server events

### start

Initializes the SocketClient instance, creates wrapped socket.io instance and so on.

**Parameters**

-   `url` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### state

Returns connection state, one of [STATES](STATES)

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### subscribe

Subscribes a listener to one of the socket or app events.

**Parameters**

-   `event` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** event name, one of SOCKET_EVENTS or APP_EVENTS
-   `listener` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** event handler

Returns **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** function you can call to unsubscribe

### unsubscribe

Unsubscribes socket or app events listener.

**Parameters**

-   `event` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** event name, one of SOCKET_EVENTS or APP_EVENTS
-   `listener` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** event handler

### send

Send a message to server

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** api method name
-   `data` **any** data to send

Returns **[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)>** server response, always returns `{}` if response is empty

### onceConnected

Executes a callback only once when socket will connect.
If socket is already connected, callback will be scheduled to run ASAP.

**Parameters**

-   `callback` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

### onceAuthenticated

Executes a callback only once when socket will authenticate.
If socket is already authenticated, callback will be scheduled to run ASAP.

**Parameters**

-   `callback` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

### onceStarted

Executes a callback once socket is started.
If socket is already started, callback will be scheduled to run ASAP.

**Parameters**

-   `callback` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

### onAuthenticated

Shortcut to frequently used 'authenticated' subscription.
Does not call handler if socket is already authenticated, only subscribes to future events.

**Parameters**

-   `handler` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

Returns **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** unsubscribe function

### onDisconnect

Shortcut to frequently used 'disconnect' subscription.
Does not call handler if socket is already disconnected, only subscribes to future events.

**Parameters**

-   `handler` **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

Returns **[function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** unsubscribe function

### close

Closes current connection and disables reconnects until open() is called.

### open

Opens a new connection. (Or does nothing if already open)

### reset

Closes connection and opens it again.

## socket

Main connection SocketClient instance.

Normally this is the only instance you should use.
It gets connection url from config and you have to call socket.start()
once everything is ready.

## Address

Virtual type representing address as server sends it.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `address` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `confirmed` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 
-   `primary` **[boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 
-   `type` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** currently always == 'email'

## KeyPair

Virtual type representing asymmetric key pair.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `publicKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes
-   `secretKey` **[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** 32 bytes or 64 bytes in case of signing key pair

## InvitedContact

Virtual type representing invited contact.
Username appears when invited contact joins Peerio.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `email` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `added` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `username` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** 

## TwoFARequest

Virtual type representing 2fa UI request.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `type` **strong** 'login' 'backupCodes' 'disable'
-   `submit` **[Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String), bool?>** function accepts TOTP code and 'trust this device' flag
-   `cancel` **[Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

## util

Various utility functions that didn't fit anywhere else.

### convertBuffers

Finds all ArrayBuffer type properties recursively and changes them to Uint8Array created with the same ArrayBuffer.

**Parameters**

-   `obj` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** object to check for ArrayBuffers.

Returns **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** same object that was passed but with some property values changed.

### formatBytes

Converts bytes number to human-readable string format.

**Parameters**

-   `bytes` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

**Examples**

```javascript
formatBytes(1024); // returns '1 KB'
```

Returns **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** formatted string.
